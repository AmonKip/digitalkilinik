
<style>
  input.ng-dirty.ng-invalid {
    border: 2px solid #ff0000
  }

  input.ng-dirty.ng-valid {
    border: 2px solid #6bc502
  }
  select.ng-dirty.ng-invalid {
    border: 2px solid #ff0000
  }

  select.ng-dirty.ng-valid {
    border: 2px solid #6bc502
  }
  #editVisit{
    visibility: visible;
  }
  textarea.ng-dirty.ng-invalid {
    border: 2px solid #ff0000
  }

  textarea.ng-dirty.ng-valid {
    border: 2px solid #6bc502
  }

  #editVisit {
    visibility: visible;
  }
  #createVisit{
    visibility:hidden;
  }
</style>
<!--<div *ngIf="visit.visitId > 0" class="alert alert-success">
    <p> Visit is there id is {{visit?.visitId}}</p>
</div>-->

<!-- Edit Visit-->


<!--<div id="editVisit">
  <div class="card create bor">
    <div class="card-body btn btn-info mb-3">
      <i class="fa fa-user-plus"></i> Edit Visit Record - {{patient.firstName}} {{patient?.lastName}}
    </div>
    <div class="cardbody ml-3 mr-3">
      <div class="form4">
        <form novalidate #form4="ngForm" (ngSubmit)="submitVisit(form4)">
          <div class="alert alert-danger"
               *ngIf="visitFormSubmitted && form4.invalid">
            There are problems with the form
          </div>

          <div class="form-group">
            <label>Complaint</label>
            <input class="form-control" [(ngModel)]="visit.complaint" name="complaint"
                   #complaint="ngModel" required />
            <ul class="text-danger list-unstyled" *ngIf="(visitFormSubmitted || complaint.dirty) && complaint.invalid">
              <li *ngFor="let error of getValidationMessages(complaint)">
                {{error}}
              </li>
            </ul>
          </div>

          <div class="form-group">
            <label>Background</label>
            <input class="form-control" [(ngModel)]="visit.background" name="background"
                   #background="ngModel" required />
            <ul class="text-danger list-unstyled" *ngIf="(visitFormSubmitted || background.dirty) && background.invalid">
              <li *ngFor="let error of getValidationMessages(background)">
                {{error}}
              </li>
            </ul>
          </div>

          <div class="mb-2 row justify-content-center align-items-center">
            <button type="submit" class="btn btn-primary mr-3">Save</button>

          </div>
        </form>
      </div>
    </div>
  </div>
</div>-->
<div *ngIf="isVisitSaved" class="card mt-2">
  <div class="card card">
    <div class="card card-header bg-info text-center" style="color:white">
      Background Info
    </div>
    <div class="card-body m-2">
      <table class="table table-striped table-sm table-bordered">
        <!--<tr><th colspan="2" class="btn btn-info text-center">Background Info</th></tr>-->
        <tr><th style="width:50%">Complaint</th><td>{{ visit?.complaint || 'No Data' }}</td></tr>
        <tr><th style="width:50%">Background</th><td>{{ visit?.background || 'No Data' }}</td></tr>
      </table>
    </div>
  </div>
</div>
<!-- New Visit-->


<div *ngIf="!isVisitSaved" class="card mt-4">
  <div class="card card-header text-center bg-info" style="color:white">
               New Visit Record - {{patient?.firstName}} {{patient?.lastName}}
  </div>
  <div class="m-3 card-body">
      <form novalidate #form1="ngForm" (ngSubmit)="submitVisit(form1)">
        <div class="alert alert-danger"
             *ngIf="visitFormSubmitted && form1.invalid">
          There are problems with the form
        </div>

        <div class="form-group">
          <label>Complaint</label>
          <input class="form-control" [(ngModel)]="newVisit.complaint" name="complaint"
                 #complaint="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(visitFormSubmitted || complaint.dirty) && complaint.invalid">
            <li *ngFor="let error of getValidationMessages(complaint)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="form-group">
          <label>Background</label>
          <input class="form-control" [(ngModel)]="newVisit.background" name="background"
                 #background="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(visitFormSubmitted || background.dirty) && background.invalid">
            <li *ngFor="let error of getValidationMessages(background)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="mb-2 row justify-content-center align-items-center">
          <button type="submit" class="btn btn-primary mr-3">Save</button>

        </div>
      </form>
  </div>
</div>

<!--Vital signs create section-->

<div *ngIf="!isVitalSignsSaved && isVisitSaved" class="card mt-4">
  <div class="card card-header bg-info text-center" style="color:white">
     Enter Patient's Vital Signs  - {{patient?.firstName}} {{patient?.lastName}}
  </div>
  <div class="card-body m-3">
    <div class="form1">
      <form novalidate #form="ngForm" (ngSubmit)="submitVitalSigns(form)">
        <div class="alert alert-danger"
             *ngIf="vitalSignsFormSubmitted && form.invalid">
          There are problems with the form
        </div>

        <div class="form-group">
          <label>Temperature</label>
          <input class="form-control" [(ngModel)]="newVitalSigns.temperature" name="temperature"
                 #temperature="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(vitalSignsFormSubmitted || temperature.dirty) && temperature.invalid">
            <li *ngFor="let error of getValidationMessages(temperature)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="form-group">
          <label>Pulse</label>
          <input class="form-control" [(ngModel)]="newVitalSigns.pulse" name="pulse"
                 #pulse="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(vitalSignsFormSubmitted || pulse.dirty) && pulse.invalid">
            <li *ngFor="let error of getValidationMessages(pulse)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="form-group">
          <label>Respiration</label>
          <input class="form-control" [(ngModel)]="newVitalSigns.respiration" name="respiration"
                 #respiration="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(vitalSignsFormSubmitted || respiration.dirty) && respiration.invalid">
            <li *ngFor="let error of getValidationMessages(respiration)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="form-group">
          <label>Blood Pressure</label>
          <input class="form-control" [(ngModel)]="newVitalSigns.bloodPressure" name="bloodPressure"
                 #bloodPressure="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(vitalSignsFormSubmitted || bloodPressure.dirty) && bloodPressure.invalid">
            <li *ngFor="let error of getValidationMessages(bloodPressure)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="form-group">
          <label>Oxygen Saturation</label>
          <input class="form-control" [(ngModel)]="newVitalSigns.oxygenSaturation" name="oxygenSaturation"
                 #oxygenSaturation="ngModel" required />
          <ul class="text-danger list-unstyled" *ngIf="(vitalSignsFormSubmitted || oxygenSaturation.dirty) && oxygenSaturation.invalid">
            <li *ngFor="let error of getValidationMessages(oxygenSaturation)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="mb-2 row justify-content-center align-items-center">
          <button type="submit" class="btn btn-primary mr-3">Save</button>

        </div>
      </form>
    </div>
  </div>
</div>

<!-- Vital sings details info -->

<div *ngIf="isVitalSignsSaved" class="card mt-2">
  <div class="card card">
    <div class="card card-header bg-info text-center" style="color:white">
      Vital Signs  - {{patient?.firstName}} {{patient?.lastName}}
    </div>
    <div class="card-body m-2">
      <table class="table table-striped table-sm table-bordered">
        <!--<tr><th colspan="2" class="btn btn-info text-center">Background Info</th></tr>-->
        <tr><th style="width:40%">Temperature</th><td>{{ vitalSigns?.temperature || 'No Data' }}</td></tr>
        <tr><th style="width:40%">Pulse</th><td>{{ vitalSigns?.pulse || 'No Data' }}</td></tr>
        <tr><th style="width:40%">Respiration</th><td>{{ vitalSigns?.respiration || 'No Data' }}</td></tr>
        <tr><th style="width:40%">Blood Pressure</th><td>{{ vitalSigns?.bloodPressure || 'No Data' }}</td></tr>
        <tr><th style="width:40%">Oxygen Saturation</th><td>{{ vitalSigns?.oxygenSaturation || 'No Data' }}</td></tr>
      </table>
    </div>
  </div>
</div>

<!-- Doctor's assessment details section -->

<div *ngIf="isAssessmentSaved" class="card mt-2">
  <div class="card card">
    <div class="card card-header bg-info text-center" style="color:white; padding-top: 1px">
      <span>
        <i class="fa fa-edit editBtn pull-right"></i>
      </span>
      Doctor's Assessment  - {{patient?.firstName}} {{patient?.lastName}}
    </div>
    <div class="card-body m-2">
      <table class="table table-striped table-sm table-bordered">
        <!--<tr><th colspan="2" class="btn btn-info text-center">Background Info</th></tr>-->
        <tr><th style="width:40%">Notes</th><td>{{ assessment?.notes || 'No Data' }}</td></tr>
      </table>
    </div>
  </div>
</div>

<!-- Doctor's assessment create section -->

<div *ngIf="!isAssessmentSaved && isVitalSignsSaved" class="card mt-5">
  <div class="card-header bg-info text-center" style="color:white">
    Doctor's Assessment - {{patient?.firstName}} {{patient?.lastName}}
  </div>
  <div class="card-body m-3">
      <form novalidate #form3="ngForm" (ngSubmit)="submitAssessment(form3)">
        <div class="alert alert-danger"
             *ngIf="assessmentFormSubmitted && form3.invalid">
          There are problems with the form
        </div>

        <div class="form-group">
          <label>Assessment Notes</label>
          <textarea class="form-control" [(ngModel)]="newAssessment.notes" name="notes"
                 #notes="ngModel" required></textarea>
          <ul class="text-danger list-unstyled" *ngIf="(assessmentFormSubmitted || notes.dirty) && notes.invalid">
            <li *ngFor="let error of getValidationMessages(notes)">
              {{error}}
            </li>
          </ul>
        </div>

        <div class="mb-2 row justify-content-center align-items-center">
          <button type="submit" class="btn btn-primary mr-3">Save</button>

        </div>
      </form>
  </div>
</div>

<!-- Add doctors orders-->
<div class="form-check mt-3" *ngIf="isAssessmentSaved">
  <label class="form-check-label">
    <input type="checkbox" class="form-check-input" (click)="checkBoxSubmit($event)">
    Check this box to add Pharmacy, Lab or Imaging Orders
  </label>
</div>


<div *ngIf="!isOrdersSaved" class="mt-4" [style.display]="isAddOrdersChecked? 'inherit':'none'">
  <form (ngSubmit)="submitOrders()" [formGroup]="form">

    <div class="form-group" formArrayName="orders">
      <div *ngFor="let order of form.controls.orders.controls;let i=index;">

        <div class="card mb-3">
          <div class="card-header bg-info text-center" style="color:white">
            Order #{{ i + 1 }}

            <span (click)="removeOrder(i)" class="pull-right btnClose" style="color:red">
              x
            </span>
          </div>

          <div class="card-block" [formGroupName]="i">
            <div class="form-group">
              <label for="type">Type</label>
              <select class="form-control" formControlName="type" id="type" required>
                <option></option>
                <option>Pharmacy</option>
                <option>Lab</option>
                <option>Imaging</option>
              </select>
              <span class="help-block" *ngIf="formErrors.orders[i].type" style="color:red">
                {{ formErrors.orders[i].type }}
              </span>
            </div>

            <div class="form-group">
              <label>Notes</label>
              <input type="text" class="form-control" formControlName="notes" required>

              <span class="help-block" *ngIf="formErrors.orders[i].notes" style="color:red">
                {{ formErrors.orders[i].notes }}
              </span>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- add order button -->
    <div class="text-left orderAdd">
      <a (click)="addAddOrder()">Add Order</a>
    </div>

    <div class="form-group text-center">
      <button type="submit" class="btn btn-primary">Save</button>
    </div>
  </form>
</div>

<!-- Doctor's orders details-->
<div *ngIf="isOrdersSaved" class="card mt-2">
  <div class="card card">
    <div class="card card-header bg-info text-center" style="color:white; padding-top: 1px">
      <span>
        <i class="fa fa-edit editBtn pull-right"></i>
      </span>
      Doctor's Orders  - {{patient?.firstName}} {{patient?.lastName}}
    </div>
    <div class="card-body m-2">
      <table class="table table-striped table-sm table-bordered">
        <tr *ngFor="let order of doctorsOrder">
          <td>{{ order?.orderType ||'No Data'}}</td>
          <td>{{ order?.notes ||'No Data'}}</td>
        </tr>
      </table>
    </div>
  </div>
</div>

<!--[style.display]="isOrdersAvailable()? 'inherit':'none'"-->
<style>
  .create {
    margin: auto;
  }
  .orderAdd{
    text-decoration: underline;
    cursor: pointer;
    color: dodgerblue;
  }
  .btnClose{
    cursor: pointer
  }
  .hideOrders{
    display : none;
  }
  .editBtn {
    color: #f0ad4e;
    cursor: pointer;
  }
  /*.displayOrders{
    display: block;
  }*/
</style>


